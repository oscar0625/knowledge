<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
<script>
    /*
    *  JavaScript 运行机制详解：再谈Event Loop
    *  http://www.ruanyifeng.com/blog/2014/10/event-loop.html#comment-text
    *
    * 1.js是单线程
    *   同一时间只能做一件事 当有多个任务时，只能按照一个顺序一个完成了再执行下一个
    *   虽然HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，
    *   但是子线程完全受主线程控制，且不得操作DOM。并没有改变JavaScript单线程的本质。
    *
    * 2.同步任务和异步任务
    *   JS分为同步任务和异步任务
    *   同步任务都在主线程上执行，形成一个"执行栈"（execution context stack） 按顺序一个一个执行
    *   遇到异步任务会将异步任务先挂起，主线程之外，事件触发线程管理着一个任务队列，只有异步任务有了运行结果，才会在任务队列之中放置一个事件。
    *   一旦执行栈中的所有同步任务执行完毕（此时JS引擎空闲），主线程就会读取任务队列，将可运行的异步任务添加到可执行栈中，开始执行。
    *   注意，总是要等待栈中的代码执行完毕后才会去读取事件队列中的事件
    *
    * 3.Event Loop 事件循环机制
    *   事件循环机制的核心是：JS引擎线程和事件触发线程
    *   主线程运行时会产生执行栈，而栈中的代码执行完毕，就会读取事件队列中的事件，去执行那些回调
    *   这个过程是循环不断的，所以整个的运行机制又称为“Event Loop”（事件循环）
    *
    * 4."任务队列" 和 回调函数
    *   "任务队列"是一个消息队列
    *       消息包括:
    *           IO设备完成一项任务(如：ajax) 就会在“任务队列”中添加一个消息，表示相关的异步任务可以进入“执行栈”。
    *           用户产生的事件后（比如鼠标点击、页面滚动等等） 就会在“任务队列”中添加一个消息，表示相关的异步任务可以进入“执行栈”。
    *           定时事件    定时(由浏览器引擎定时)在“任务队列”中添加一个消息，表示相关的异步任务可以进入“执行栈”
    *
    *    回调函数
    *    异步任务必须指定回调函数，当主线程开始执行"任务队列" 中的消息，就是执行对应的回调函数。
    *
    *    任务队列”是一个先进先出的数据结构，排在前面的消息，优先被主线程读取。
    *    主线程的读取过程基本上是自动的，只要执行栈一清空，“任务队列”上第一位的消息就自动进入主线程。
    * 5.单独说说定时器
    *   事件循环机制的核心是JS引擎线程和事件触发线程。但事件上，里面还有一些隐藏细节，譬如调用setTimeout后，是如何等待特定时间后才添加到事件队列中的？  
    *   是JS引擎检测的么？当然不是了。它是由定时器线程控制（因为JS引擎自己都忙不过来，根本无暇分身）
    *   为什么要单独的定时器线程？因为JavaScript引擎是单线程的, 如果处于阻塞线程状态就会影响记计时的准确，因此很有必要单独开一个线程用来计时。
    *   什么时候会用到定时器线程？当使用setTimeout或setInterval时，它需要定时器线程计时，计时完成后就会将特定的事件推入事件队列中。
    *
    * */

</script>
</html>